# Sonar system (192.168.10.188) cranberrypi
#
record(ai, "Env-CmpRoom:TT001:sRdV") {
   field (DESC, "Temperature")
   field (EGU, "ᵒC")
   field (DTYP, "Soft Channel")
   field (LOPR, "10.0")
   field (HOPR, "30.0")
   field (PREC, "1")
   field (INP, "Sonar:T")
   field (SCAN, "10 second")
}

record(ai, "Cryo-Rec:LP:GasBagSonar-raw") {
   field (DESC, "Distance sensor- balloon (raw value)")
   field (EGU, "cm")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "200.0")
   field (PREC, "0")
   field (INP, "Sonar:Dist")
   field (SCAN, "10 second")
}

record(ai, "Cryo-Rec:LP:GasBagSonar") {
   field (DESC, "Distance sensor- balloon")
   field (EGU, "cm")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "200.0")
   field (PREC, "0")
   field (FLNK, "Cryo-Rec:LP:GasBagSonar-smooth")
   field (INP, "Cryo-Rec:LP:GasBagSonar-good")
 }

record(ai, "Cryo-Rec:LP:GasBagSonar-smooth") {
   field (DESC, "Distance sensor- balloon")
   field (EGU, "cm")
   field (DTYP, "Raw Soft Channel")
   field (LOPR, "0")
   field (HOPR, "200.0")
   field (SMOO, "0.95")
   field (PREC, "1")
   field (INP, "Cryo-Rec:LP:GasBagSonar")
 }

# This record must be processed in the start-up script or
# manually by the operator to initialize it to a good value from Sonar:Dist
#
record (ao, "Cryo-Rec:LP:GasBagSonar-good") {
  field (DTYP, "Soft Channel")
#  field (PINI, "YES")
  field (DOL, "Sonar:Dist")
  field (OMSL, "closed_loop")
  field (FLNK, "Cryo-Rec:LP:GasBagSonar")
}
# Help record to filter unexpected data (differing by more than value in INPD)
# from the last "good" value
record(calcout, "Cryo-Rec:LP:GasBagSonar-calc") {
  field (SCAN, "10 second")
  field (DESC,"Record for validating Sonar:Dist")
  field (INPA, "Sonar:Dist")
  field (INPB, "Cryo-Rec:LP:GasBagSonar-good")
  field (INPD, "15")
  field (CALC, "((ABS(A-B))>D)?1:0")
  field (OOPT, "When Zero")
  field (OCAL, "A")
  field (DOPT, "Use OCAL")
  field (OUT, "Cryo-Rec:LP:GasBagSonar-good PP")
#  field (PINI, "YES")
}

record(calc, "Cryo-Rec:LP:GasBagSonar-rate") {
  field (SCAN, "60 second")
  field (DESC,"Rate of gas bag height change")
  field (INPA, "Cryo-Rec:LP:GasBagSonar-smooth")
  field (INPB, "Cryo-Rec:LP:GasBagSonar-rate.LA")
  field (CALC, "B-A")
  field (EGU, "cm/min")
}

record(ai, "Cryo-Rec:LP:GasBagVol") {
   field (DESC, "Volume balloon")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "120.0")
   field (PREC, "1")
   field (INP, "Sonar:Vbag")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:Total") {
   field (DESC, "Helium's total volume")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "3000.0")
   field (PREC, "1")
   field (INP, "Sonar:Total")
   field (SCAN, "10 second")
}

# raspi 192.168.10.187 (close to Linde control cabinet)
#
record(ai, "Cryo:HeVol:Total-Expected") {
   field (DESC, "Helium's expected volume")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "3000.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:Expected")
   field (SCAN, "10 second")
}

# Weather station freiapi 04 192.168.10.171 (shelf in front of the control room)
#
record(ai, "Env-FREIA:PT001:sRdV") {
   field (DESC, "Atmospheric pressure")
   field (EGU, "mbar")
   field (DTYP, "Soft Channel")
   field (LOPR, "900")
   field (HOPR, "1100.0")
   field (PREC, "1")
   field (INP, "Weather:Pressure")
   field (SCAN, "10 second")
}

record(ai, "Env-FREIA:TT001:sRdV") {
   field (DESC, "Ambient temperature")
   field (EGU, "ᵒC")
   field (DTYP, "Soft Channel")
   field (LOPR, "10")
   field (HOPR, "30.0")
   field (PREC, "1")
   field (INP, "Weather:PressureT")
   field (SCAN, "10 second")
}

record(ai, "Env-FREIA:TT002:sRdV") {
   field (DESC, "Ambient temperature")
   field (EGU, "ᵒC")
   field (DTYP, "Soft Channel")
   field (LOPR, "10")
   field (HOPR, "30.0")
   field (PREC, "1")
   field (INP, "Weather:HumidityT")
   field (SCAN, "10 second")
}

record(ai, "Env-FREIA:HT002:sRdV") {
   field (DESC, "Ambient relative humidity")
   field (EGU, "%")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "100.0")
   field (PREC, "1")
   field (INP, "Weather:Humidity")
   field (SCAN, "10 second")
}

# raspi 192.168.10.187 (close to Linde control cabinet)
#
record(ai, "Env-FREIA:TT003:sRdV") {
   field (DESC, "Ambient temperature")
   field (EGU, "ᵒC")
   field (DTYP, "Soft Channel")
   field (LOPR, "10")
   field (HOPR, "30.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:T")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:In") {
   field (DESC, "Volume of return gas")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "100.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:Vin")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:Out") {
   field (DESC, "Volume of delivered gas")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "1000.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:Vout")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:Dwr") {
   field (DESC, "Volume of He in dewar")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "2000.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:Vdew")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:HP") {
   field (DESC, "Helium Volume in high pressure tank")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "200.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:Vhp")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:BuffTank") {
   field (DESC, "Helium Volume in buffer tank")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "100.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:Vbuf")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:4K") {
   field (DESC, "Helium Volume in 4K system")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "100.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:V4K")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:2K") {
   field (DESC, "Helium Volume in 2K system")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "100.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:V2K")
   field (SCAN, "10 second")
}

record(ai, "Cryo:HeVol:CM") {
   field (DESC, "He in the cryomodule")
   field (EGU, "m³")
   field (DTYP, "Soft Channel")
   field (LOPR, "0")
   field (HOPR, "100.0")
   field (PREC, "1")
   field (INP, "HeliumVolume:CryoModVol")
   field (SCAN, "10 second")
}
